(function(t){function e(e){for(var a,r,o=e[0],c=e[1],u=e[2],p=0,d=[];p<o.length;p++)r=o[p],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&d.push(i[r][0]),i[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);l&&l(e);while(d.length)d.shift()();return s.push.apply(s,u||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],a=!0,o=1;o<n.length;o++){var c=n[o];0!==i[c]&&(a=!1)}a&&(s.splice(e--,1),t=r(r.s=n[0]))}return t}var a={},i={index:0},s=[];function r(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=a,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/canvas-mask/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var l=c;s.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0e80":function(t,e,n){},"16a3":function(t,e,n){"use strict";n("cd8c")},"1bff":function(t,e,n){},"2c04":function(t,e,n){},"30dd":function(t,e,n){"use strict";n("2c04")},5277:function(t,e,n){"use strict";n("1bff")},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("Navbar"),n("router-view")],1)},s=[],r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("nav",[n("router-link",{staticClass:"logo",attrs:{to:"/"}},[t._v("Canvas Mask")]),n("router-link",{staticClass:"page-link",attrs:{to:"/"}},[t._v("Home")]),n("router-link",{staticClass:"page-link",attrs:{to:"/playground"}},[t._v("Playground")]),n("a",{staticClass:"github-link",attrs:{href:"https://github.com/vii120/canvas-mask",target:"_blank",rel:"noopener"}},[t._v(" Github ")])],1)},o=[],c={name:"Navbar"},u=c,l=(n("16a3"),n("2877")),p=Object(l["a"])(u,r,o,!1,null,null,null),d=p.exports,m={name:"App",components:{Navbar:d}},f=m,g=(n("5c0b"),Object(l["a"])(f,i,s,!1,null,null,null)),h=g.exports,v=n("8c4f"),b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"intro-wrapper"},[a("div",{staticClass:"demo-box"},[a("img",{staticClass:"demo-origin",attrs:{src:n("e0ad"),alt:"draw"}}),a("img",{staticClass:"demo-draw",attrs:{src:n("b59b"),alt:"draw"}}),a("img",{staticClass:"demo-transparent",attrs:{src:n("71c6"),alt:"transparent"}}),a("img",{staticClass:"demo-colored",attrs:{src:n("a7a0"),alt:"result"}}),a("div",{staticClass:"title-box"},[a("h1",{staticClass:"logo"},[t._v("Canvas Mask")]),a("h2",[t._v("crop picture with what you paint!")]),a("router-link",{staticClass:"btn start-btn",attrs:{to:"/playground"}},[t._v(" try it! ")])],1)])])},O=[],C={name:"Intro"},w=C,y=(n("c6b68"),Object(l["a"])(w,b,O,!1,null,null,null)),_=y.exports,j=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"playground"},[t.uploadImg?[n("Tools"),n("ImgSection")]:n("Upload")],2)},x=[],E=n("5530"),T=n("2f62"),S=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.uploadImg?t._e():n("div",{staticClass:"upload-wrapper"},[n("input",{attrs:{type:"file",id:"file",accept:"image/*"},on:{change:t.onUpload}}),n("label",{staticClass:"btn",attrs:{for:"file"}},[t._v(" "+t._s(t.isUploading?"loading...":"upload your image")+" ")])])},P=[],I={name:"Upload",computed:Object(E["a"])({},Object(T["c"])("Image",["uploadImg","isUploading"])),methods:Object(E["a"])({},Object(T["b"])("Image",["onUpload"]))},D=I,k=(n("f463"),Object(l["a"])(D,S,P,!1,null,null,null)),U=k.exports,z=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tool-wrapper"},[t.displayOutput?t._e():n("div",{staticClass:"switch-btn tool-btn"},t._l(t.switchBtns,(function(e,a){return n("div",{key:a,staticClass:"btn",class:{active:t.penType===e},on:{click:function(n){return t.changePenType(e)}}},[t._v(" "+t._s(e)+" ")])})),0),t.displayOutput?t._e():n("div",{staticClass:"range-box"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.pen,expression:"pen"}],attrs:{type:"range",min:"5",max:"50"},domProps:{value:t.pen},on:{__r:function(e){t.pen=e.target.value}}}),n("div",{staticClass:"num"},[t._v(t._s(t.penSize))])]),t.displayOutput?t._e():n("div",{staticClass:"btn tool-btn",on:{click:t.resetCanvasEl}},[t._v(" clear ")]),n("div",{staticClass:"btn tool-btn",on:{click:t.toggleDisplay}},[t._v(" "+t._s(t.displayOutput?"edit mode":"generate")+" ")])])},R=[],M={name:"Tools",computed:Object(E["a"])(Object(E["a"])(Object(E["a"])({},Object(T["c"])("Tools",["switchBtns","penType","penSize"])),Object(T["c"])("Image",["canvasEl","displayOutput"])),{},{pen:{get:function(){return this.penSize},set:function(t){this.updatePenSize(t)}}}),methods:Object(E["a"])(Object(E["a"])({},Object(T["b"])("Tools",["changePenType","updatePenSize"])),Object(T["b"])("Image",["toggleDisplay","resetCanvasEl"]))},A=M,N=(n("ba20"),Object(l["a"])(A,z,R,!1,null,null,null)),X=N.exports,H=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"img-section",class:[t.imgClass]},[n("Result",{directives:[{name:"show",rawName:"v-show",value:t.delayDisplayOutput,expression:"delayDisplayOutput"}]}),n("Canvas",{directives:[{name:"show",rawName:"v-show",value:!t.delayDisplayOutput,expression:"!delayDisplayOutput"}]})],1)},Y=[],W=n("1da1"),$=(n("96cf"),n("d3b7"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"canvas-wrapper",style:{width:t.imgWidth+"px",height:t.imgHeight+"px"}},[n("div",{staticClass:"canvas-bg",style:{"background-image":"url("+t.uploadImg+")"}}),n("canvas",{ref:"canvas",on:{touchstart:t.onDrawStart,touchmove:t.onDrawing,touchend:t.onDrawEnd,mousedown:t.onDrawStart,mousemove:t.onDrawing,mouseup:t.onDrawEnd,mouseout:t.onDrawEnd}}),n("div",{staticClass:"custom-cursor",class:{eraser:t.useEraser},style:{top:t.currentY+"px",left:t.currentX+"px",width:t.penSize+"px",height:t.penSize+"px"}}),n("div",{staticClass:"reupload-btn",on:{click:t.resetUploadImg}},[t._v(" change another photo ")])])}),G=[],L={name:"Canvas",data:function(){return{canvasCtx:null,isDrawing:!1,currentX:null,currentY:null}},watch:{penSize:function(t){this.canvasCtx.lineWidth=t}},computed:Object(E["a"])(Object(E["a"])(Object(E["a"])({},Object(T["c"])("Image",["uploadImg","imgWidth","imgHeight","canvasEl"])),Object(T["c"])("Tools",["penType","penSize"])),{},{useEraser:function(){return"eraser"===this.penType}}),methods:Object(E["a"])(Object(E["a"])({},Object(T["b"])("Image",["updateCanvasEl","resetUploadImg"])),{},{setTouchPosition:function(t){if(void 0===t.offsetX){var e=t.target.getBoundingClientRect();this.currentX=t.targetTouches[0].clientX-e.x,this.currentY=t.targetTouches[0].clientY-e.y}},setMousePosition:function(t){if(t.offsetX){var e=[t.offsetX,t.offsetY];this.currentX=e[0],this.currentY=e[1]}},clearCanvas:function(t){this.setTouchPosition(t),this.setMousePosition(t),this.canvasCtx.clearRect(this.currentX,this.currentY,this.penSize,this.penSize)},onDrawStart:function(t){this.isDrawing||(this.isDrawing=!0,this.setTouchPosition(t),this.setMousePosition(t))},onDrawing:function(t){if(this.isDrawing)if(this.useEraser)this.clearCanvas(t);else{var e,n;if(void 0===t.offsetX){var a=t.target.getBoundingClientRect();e=t.targetTouches[0].clientX-a.x,n=t.targetTouches[0].clientY-a.y}else{var i=[t.offsetX,t.offsetY];e=i[0],n=i[1]}this.canvasCtx.beginPath(),this.canvasCtx.moveTo(this.currentX,this.currentY),this.canvasCtx.lineTo(e,n),this.canvasCtx.stroke();var s=[e,n];this.currentX=s[0],this.currentY=s[1]}else this.setMousePosition(t)},onDrawEnd:function(){this.isDrawing&&(this.isDrawing=!1)},initCanvas:function(){var t=this.$refs.canvas;t.width=this.imgWidth,t.height=this.imgHeight,this.updateCanvasEl(t),this.canvasCtx=t.getContext("2d"),this.canvasCtx.lineJoin="round",this.canvasCtx.lineCap="round",this.canvasCtx.lineWidth=this.penSize,this.canvasCtx.strokeStyle="#fff"}}),mounted:function(){this.initCanvas()}},B=L,J=(n("5277"),Object(l["a"])(B,$,G,!1,null,"214d2b20",null)),V=J.exports,Z=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"result-wrapper"},[n("div",{staticClass:"img-wrapper",style:{width:t.imgWidth+"px",height:t.imgHeight+"px","background-color":t.isTransparent?"transparent":t.bgColor}},[n("div",{staticClass:"result-img",style:{"background-image":"url("+t.uploadImg+")","mask-image":"url("+t.canvasOutput+")"}})]),n("div",{staticClass:"btn-box"},[n("input",{attrs:{type:"color",id:"color"},domProps:{value:t.bgColor},on:{input:t.onSelectColor}}),n("label",{staticClass:"btn",attrs:{for:"color"}},[t._v(" select background ")]),n("div",{staticClass:"check-wrapper",on:{click:function(e){t.isTransparent=!t.isTransparent}}},[n("span",{staticClass:"switcher",class:{active:t.isTransparent}}),t._v(" transparent ")])])])},q=[],F={name:"Result",data:function(){return{bgColor:"#ffffff",isTransparent:!0}},computed:Object(E["a"])({},Object(T["c"])("Image",["uploadImg","imgWidth","imgHeight","canvasOutput"])),methods:{onSelectColor:function(t){this.bgColor=t.target.value,this.isTransparent=!1}}},K=F,Q=(n("aada"),Object(l["a"])(K,Z,q,!1,null,null,null)),tt=Q.exports,et=function(t){return new Promise((function(e){return setTimeout(e,t)}))},nt={name:"ImgSection",components:{Canvas:V,Result:tt},data:function(){return{imgClass:"",delayDisplayOutput:!1}},watch:{displayOutput:function(t){var e=this;return Object(W["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.imgClass="fadeout",n.next=3,et(300);case 3:e.imgClass="",e.delayDisplayOutput=t;case 5:case"end":return n.stop()}}),n)})))()}},computed:Object(E["a"])({},Object(T["c"])("Image",["displayOutput"])),mounted:function(){this.delayDisplayOutput=this.displayOutput}},at=nt,it=(n("bc15"),Object(l["a"])(at,H,Y,!1,null,null,null)),st=it.exports,rt={name:"Playground",components:{Upload:U,ImgSection:st,Tools:X},computed:Object(E["a"])({},Object(T["c"])("Image",["uploadImg"])),mounted:function(){window.scrollTo(0,0)}},ot=rt,ct=(n("30dd"),Object(l["a"])(ot,j,x,!1,null,null,null)),ut=ct.exports;a["a"].use(v["a"]);var lt,pt,dt=new v["a"]({mode:"hash",base:"/canvas-mask/",routes:[{path:"/",redirect:{name:"Home"}},{path:"/",name:"Home",component:_},{path:"/playground",name:"Playground",component:ut},{path:"*",redirect:"/"}]}),mt=n("ade3"),ft=n("3835"),gt=(n("3ca3"),n("ddb0"),n("2b3d"),{uploadImg:null,isUploading:!1,imgWidth:null,imgHeight:null,canvasEl:null,canvasOutput:null,displayOutput:!1}),ht="UPDATE_USER_IMAGE",vt="UPDATE_LOADING",bt="SET_IMAGE_SIZE",Ot="RESET_CANVAS_ELEMENT",Ct="UPDATE_CANVAS_ELEMENT",wt="GENERATE_OUTPUT",yt="TOGGLE_OUTPUT_DISPLAY",_t={onUpload:function(t,e){return Object(W["a"])(regeneratorRuntime.mark((function n(){var a,i,s,r,o,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=t.commit,i=t.dispatch,s=Object(ft["a"])(e.target.files,1),r=s[0],o=URL.createObjectURL(r),c=new Image,c.src=o,a(vt,!0),n.next=8,c.decode();case 8:i("getUploadSize",c),a(ht,o),a(vt,!1);case 11:case"end":return n.stop()}}),n)})))()},resetUploadImg:function(t){var e=t.commit;e(ht,null)},getUploadSize:function(t,e){var n=t.commit,a=e.width,i=e.height,s=.9*window.innerHeight,r=.9*window.innerWidth,o=a,c=i;o>r&&(o=r,c=r*i/a),c>s&&(c=s,o=s*a/i),n(bt,{width:o,height:c})},updateCanvasEl:function(t,e){var n=t.commit;n(Ct,e)},resetCanvasEl:function(t){var e=t.commit;e(Ot)},onGenerate:function(t){var e=t.commit;e(wt,gt.canvasEl.toDataURL("image/png"))},toggleDisplay:function(t){var e=t.commit,n=t.dispatch;gt.displayOutput||n("onGenerate"),e(yt)}},jt=(lt={},Object(mt["a"])(lt,ht,(function(t,e){t.uploadImg=e})),Object(mt["a"])(lt,vt,(function(t,e){t.isUploading=e})),Object(mt["a"])(lt,bt,(function(t,e){t.imgWidth=Math.floor(e.width),t.imgHeight=Math.floor(e.height)})),Object(mt["a"])(lt,Ct,(function(t,e){t.canvasEl=e})),Object(mt["a"])(lt,Ot,(function(t){t.canvasEl.getContext("2d").clearRect(0,0,t.imgWidth,t.imgHeight)})),Object(mt["a"])(lt,wt,(function(t,e){t.canvasOutput=e})),Object(mt["a"])(lt,yt,(function(t){t.displayOutput=!t.displayOutput})),lt),xt={namespaced:!0,state:gt,actions:_t,mutations:jt},Et={switchBtns:["pen","eraser"],penType:"pen",penSize:20},Tt="CHANGE_PEN_TYPE",St="UPDATE_PEN_SIZE",Pt={changePenType:function(t,e){var n=t.commit;n(Tt,e)},updatePenSize:function(t,e){var n=t.commit;n(St,e)}},It=(pt={},Object(mt["a"])(pt,Tt,(function(t,e){t.penType=e})),Object(mt["a"])(pt,St,(function(t,e){t.penSize=e})),pt),Dt={namespaced:!0,state:Et,actions:Pt,mutations:It};a["a"].use(T["a"]);var kt=new T["a"].Store({modules:{Image:xt,Tools:Dt},strict:!1});n("7361");a["a"].config.productionTip=!1,new a["a"]({render:function(t){return t(h)},router:dt,store:kt}).$mount("#app")},5933:function(t,e,n){},"5c0b":function(t,e,n){"use strict";n("9c0c")},6308:function(t,e,n){},6739:function(t,e,n){},"71c6":function(t,e,n){t.exports=n.p+"img/demo-result-transparent.5a01b2ce.png"},7361:function(t,e,n){},"8cda":function(t,e,n){},"9c0c":function(t,e,n){},a7a0:function(t,e,n){t.exports=n.p+"img/demo-result.f5d1a5b2.png"},aada:function(t,e,n){"use strict";n("0e80")},b59b:function(t,e,n){t.exports=n.p+"img/demo-draw.136b2336.png"},ba20:function(t,e,n){"use strict";n("5933")},bc15:function(t,e,n){"use strict";n("6739")},c6b68:function(t,e,n){"use strict";n("6308")},cd8c:function(t,e,n){},e0ad:function(t,e,n){t.exports=n.p+"img/demo-origin.8a8fbfde.png"},f463:function(t,e,n){"use strict";n("8cda")}});
//# sourceMappingURL=index.991774c3.js.map